<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Mentor Profile - VisMen</title>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
  <style>
    * {
      box-sizing: border-box;
      font-family: 'Inter', sans-serif;
      margin: 0;
      padding: 0;
    }

    body {
      background: #f4f6fc;
      display: flex;
      min-height: 100vh;
    }

    .sidebar {
      background: #04367d;
      color: white;
      width: 220px;
      padding: 20px 0;
      position: fixed;
      top: 0;
      bottom: 0;
    }

    .sidebar h2 {
      text-align: center;
      margin-bottom: 30px;
    }

    .sidebar ul {
      list-style: none;
      padding-left: 0;
    }

    .sidebar ul li {
      padding: 15px 20px;
      cursor: pointer;
    }

    .sidebar ul li:hover,
    .sidebar ul li.active {
      background-color: #0d47a1;
    }

    .main-content {
      margin-left: 220px;
      padding: 40px;
      flex: 1;
    }

    .header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 30px;
    }

    .header h1 {
      font-size: 26px;
    }

    .btn-edit {
      padding: 10px 16px;
      background-color: #3654ff;
      color: white;
      border: none;
      border-radius: 5px;
      cursor: pointer;
    }

    .profile-section {
      background: white;
      border-radius: 10px;
      padding: 30px;
      box-shadow: 0 2px 5px rgba(0,0,0,0.08);
    }

    .profile-row {
      display: flex;
      justify-content: space-between;
      margin-bottom: 15px;
    }

    .profile-row div {
      flex: 1;
      margin-right: 30px;
    }

    .profile-row div:last-child {
      margin-right: 0;
    }

    .section-title {
      font-weight: bold;
      margin-top: 30px;
      margin-bottom: 10px;
    }

    .verified {
      color: #3654ff;
      font-weight: bold;
      font-size: 14px;
    }

    .download-link {
      color: #3654ff;
      text-decoration: underline;
      cursor: pointer;
    }

    footer {
      margin-top: 50px;
      padding: 10px;
      text-align: center;
      background: #04367d;
      color: white;
    }

    .profile-pic {
      display: flex;
      align-items: center;
      margin-bottom: 20px;
    }

    .profile-pic img {
      width: 70px;
      height: 70px;
      border-radius: 50%;
      margin-right: 20px;
    }

     .modal {
      display: none;
      position: fixed;
      top: 0; left: 0; right: 0; bottom: 0;
      background: rgba(0,0,0,0.5);
      justify-content: center;
      align-items: center;
    }

    .modal-content {
      background: white;
      padding: 20px;
      border-radius: 10px;
      width: 500px;
    }

    .modal-content input, .modal-content textarea {
      width: 100%;
      padding: 8px;
      margin: 8px 0;
      border: 1px solid #ccc;
      border-radius: 5px;
    }

    .modal-content button {
      background-color: #3654ff;
      color: white;
      padding: 10px 15px;
      border: none;
      border-radius: 5px;
      cursor: pointer;
      margin-top: 10px;
    }

  </style>
</head>
<body>
  <div class="sidebar">
    <h2>VISMEN</h2>
    <ul>
      <li onclick="location.href='mentor-dashboard.html'">Dashboard</li>
      <li onclick="location.href='mentor-bookings.html'">Bookings</li>
      <li onclick="location.href='mentor-earnings.html'">Earnings</li>
      <li onclick="location.href='mentor-messages.html'">Messages</li>
      <li class="active">Profile</li>
    </ul>
  </div>

  <div class="main-content">
    <div class="header">
      <h1>Account</h1>
 <button class="btn-edit" onclick="openModal()">Edit Profile</button>
      </div>

    <div class="profile-section">
      <div class="profile-pic">
        <img id="mentorImage" src="/Mentor1.jpg" alt="Profile Photo" />
        <div>
          <h3 id="mentorName">Mentor</h3>
          <p class="verified">✔ Verified</p>
        </div>
      </div>

      <div class="profile-row">
        <div>
          <strong>Full Name</strong>
          <p id="fullName">-</p>
        </div>
        <div>
          <strong>Email</strong>
          <p id="email">-</p>
        </div>
      </div>

      <div class="profile-row">
        <div>
          <strong>Phone</strong>
          <p id="phone">-</p>
        </div>
        <div>
          <strong>Languages</strong>
          <p id="languages">-</p>
        </div>
      </div>

      <div class="section-title">Professional Details</div>
      <div class="profile-row">
        <div>
          <strong>Expertise Areas</strong>
          <p id="skills">-</p>
        </div>
        <div>
          <strong>Experience</strong>
          <p id="experience">-</p>
        </div>
      </div>

      <div>
        <strong>Bio</strong>
        <p id="bio">-</p>
      </div>
      <div style="margin-top: 10px;">
        <strong>Resume / CV</strong>
        <a id="resume" class="download-link" href="#" target="_blank">Download</a>
      </div>

      <div class="section-title">Security</div>
      <div class="profile-row">
        <div>
          <strong>Payout Account</strong>
          <p id="payout">-</p>
        </div>
        <div>
          <strong>Payout Frequency</strong>
          <p id="payoutFrequency">-</p>
        </div>
      </div>

      <div class="section-title">Security Options</div>
      <ul style="margin-left: 20px; line-height: 2;">
        <li>Change Password</li>
        <li>Add ZTA</li>
        <li>Login History</li>
      </ul>

      <div class="section-title">Account Actions</div>
      <ul style="margin-left: 20px; line-height: 2;">
        <li>Download Data</li>
        <li>Clear History</li>
      </ul>
    </div>

    <footer>
      © 2025 VisMen IT Solutions. All rights reserved.
    </footer>
  </div>

   <div class="modal" id="editModal">
    <div class="modal-content">
      <h3>Edit Mentor Profile</h3>
      <input type="text" id="inputPhone" placeholder="Phone">
      <input type="text" id="inputLanguages" placeholder="Languages">
      <input type="text" id="inputExpertise" placeholder="Expertise Areas">
      <input type="text" id="inputExperience" placeholder="Experience">
      <textarea id="inputBio" placeholder="Bio"></textarea>
      <input type="text" id="inputPayout" placeholder="Payout Account">
      <input type="text" id="inputFrequency" placeholder="Payout Frequency">
      <button onclick="saveProfile()">Save</button>
    </div>
  </div>

  <script>
  const email = localStorage.getItem('email');
  if (!email) {
    alert("Please log in first.");
    window.location.href = "/login.html";
  }

  let mentorData = {};

  async function loadMentorProfile() {
    try {
      const res = await fetch(`/get-mentor-data?email=${email}`);
      const data = await res.json();
      if (data.error) return alert(data.error);

      mentorData = data;

      document.getElementById("mentorImage").src = data.image || "Mentor1.jpg";
      document.getElementById("mentorName").textContent = data.name || "Mentor";
      document.getElementById("fullName").textContent = data.name || "-";
      document.getElementById("email").textContent = data.email || "-";
      document.getElementById("phone").textContent = data.phone || "*XXXX";
      document.getElementById("languages").textContent = data.languages || "-";
      document.getElementById("skills").textContent = data.expertise || "-";
      document.getElementById("experience").textContent = data.experience || "-";
      document.getElementById("bio").textContent = data.bio || "-";
      document.getElementById("resume").href = data.resume || "#";
      document.getElementById("payout").textContent = data.payout || "-";
      document.getElementById("payoutFrequency").textContent = data.frequency || "-";
    } catch (err) {
      console.error("Error loading mentor profile:", err);
      alert("Failed to load profile.");
    }
  }

  function openModal() {
    document.getElementById("editModal").style.display = "flex";
    document.getElementById("inputPhone").value = mentorData.phone || '';
    document.getElementById("inputLanguages").value = mentorData.languages || '';
    document.getElementById("inputExpertise").value = mentorData.expertise || '';
    document.getElementById("inputExperience").value = mentorData.experience || '';
    document.getElementById("inputBio").value = mentorData.bio || '';
    document.getElementById("inputPayout").value = mentorData.payout || '';
    document.getElementById("inputFrequency").value = mentorData.frequency || '';
  }

  async function saveProfile() {
    const updated = {
      email,
      phone: document.getElementById("inputPhone").value,
      languages: document.getElementById("inputLanguages").value,
      expertise: document.getElementById("inputExpertise").value,
      experience: document.getElementById("inputExperience").value,
      bio: document.getElementById("inputBio").value,
      payout: document.getElementById("inputPayout").value,
      frequency: document.getElementById("inputFrequency").value
    };

    try {
      const res = await fetch('/update-mentor-profile', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify(updated)
      });

      const result = await res.json();
      if (result.success) {
        alert("✅ Profile updated!");
        document.getElementById("editModal").style.display = "none";
        loadMentorProfile();
      } else {
        alert("❌ Update failed.");
      }
    } catch (err) {
      console.error("Error updating profile:", err);
      alert("Error occurred during update.");
    }
  }

  window.addEventListener('DOMContentLoaded', loadMentorProfile);
</script>

</body>
</html>
